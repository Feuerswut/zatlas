!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).DsHeightmap=f()}}(function(){return function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){return o(e[i][1][r]||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}({1:[function(require,module,exports){"use strict";var average=require("./utils").average,fillArray=require("./utils").fillArray,makeValInRange=require("./utils").makeValInRange,posInArray=(require("./utils").rgbToHex,require("./utils").posInArray),POWER_MIN=2,POWER_MAX=12,SMOOTH_MAX=3,_data=[],_corners=[],_power=7,_corner=[1,1,1,1],_offset=-.2,_range=7,_rough=.8,_smooth=3,_max=0,_initialAverage=0,ds={init:function(r){(function(r,a){var e=Number.isInteger(r)?r:Number.parseInt(r);_power=e<0?POWER_MIN:POWER_MAX<e?POWER_MAX:e,_max=Math.pow(2,_power)+1,_offset="number"==typeof a.offset?makeValInRange(a.offset,-1,1):_offset,_range="number"==typeof a.range?makeValInRange(a.range,1,10):_range,_rough="number"==typeof a.rough?makeValInRange(a.rough,0,.9):_rough,_smooth="number"==typeof a.smooth?makeValInRange(a.smooth,0,SMOOTH_MAX):_smooth;var n=a.corner?fillArray(4,a.corner):Array(4).fill(null);_corner=n.map(function(r){return null===r?Math.random()*_range:r<0?0:_range<r?_range:r}),_corners.push([0,0],[_max-1,0],[_max-1,_max-1],[0,_max-1]),_initialAverage=average(_corner)})(r,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}),function(){for(var r=0;r<_max;++r)_data.push(Array(_max).fill(0));_corners.forEach(function(r,a){set.apply(void 0,function(r){if(Array.isArray(r)){for(var a=0,e=Array(r.length);a<r.length;a++)e[a]=r[a];return e}return Array.from(r)}(r).concat([_corner[a]]))})}()},run:function(){(function diamondSquare(r){var a=r/2,e=void 0,n=void 0;if(a<1)return _data;for(n=a;n<_max;n+=r)for(e=a;e<_max;e+=r)notCorner(e,n)&&square(e,n,a);for(n=0;n<_max;n+=a)for(e=(n+a)%r;e<_max;e+=r)notCorner(e,n)&&diamond(e,n,a);diamondSquare(r/2)})(_max-1),0<_smooth&&this.smooth(_smooth)},out:function(){return _data},smooth:function(r){makeValInRange(r,0,SMOOTH_MAX),_data.forEach(function(a,e){a.forEach(function(a,n){for(var o=0,t=null,_=e-1;_<=e+1;++_)for(var u=n-1;u<=n+1&&!(_<0||_max-1<_||u<0||_max-1<u)&&(_!==e||u!==n);++u)_data[_][u]===a?++o:t||(t=_data[_][u]),_===e+1&&u===n+1&&o<r&&(_data[e][n]=t)})})}};function get(r,a){return r<0||_max-1<r||a<0||_max-1<a?_initialAverage:_data[r][a]}function set(r,a,e){_data[r][a]=e}function square(r,a,e){set(r,a,getValue(average([get(r-e,a-e),get(r+e,a-e),get(r+e,a+e),get(r-e,a+e)]),e))}function diamond(r,a,e){set(r,a,getValue(average([get(r,a-e),get(r+e,a),get(r,a+e),get(r-e,a)]),e))}function getValue(r,a){return makeValInRange(Math.round(r+function(r){var a=r/_max/(1-_rough);return(Math.random()+_offset)*_range*a}(a)),-_range,_range)}function notCorner(r,a){return 0!==r&&r!==_max-1&&0!==a&&a!==_max-1||!posInArray(r,a,_corners)}module.exports=ds},{"./utils":2}],2:[function(require,module,exports){"use strict";var utils={average:function(r){return r.reduce(function(r,n){return r+n})/r.length},fillArray:function(r,n){return"number"==typeof i?Array(r).fill(n):Array.isArray(n)?n.length<r?n.concat(Array(r-n.length).fill(n[n.length-1])):n.length>r?n.slice(0,r):n:[1,1,1,1]},makeValInRange:function(r,n,e){var a=void 0,t=void 0;return n<=e?(a=n,t=e):(a=e,t=n),t<r?t:r<a?a:r},rgbToHex:function(r,n,e){return"#"+((1<<24)+(r<<16)+(n<<8)+e).toString(16).slice(1)},posInArray:function(r,n,e){return e.some(function(e,a,t){return e[0]===r&&e[1]===n})}};module.exports=utils},{}]},{},[1])(1)});